<!DOCTYPE html>

<html>
<head>
  <meta charset=utf-8/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Realtime database</title>
</head>
<body>

  <select id="drivers">

  </select>

  <label for="long">Longititude</label>
  <input id="long" type="hidden">
  <br>
  <label for="lat">Latitude</label>
  <input id="lat" type="hidden">
  <br>
  <button onclick="submitButton()" id="sbmtBtn">Submit</button>


<script src="https://www.gstatic.com/firebasejs/4.1.2/firebase.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDCsJrmJL642SeNacJcRGL6Yw56CLd0Ivg",
    authDomain: "realtime-test-8f9f1.firebaseapp.com",
    projectId: "realtime-test-8f9f1",
    storageBucket: "realtime-test-8f9f1.appspot.com",
    messagingSenderId: "532568286105",
    appId: "1:532568286105:web:935501aa36608bed04e908",
    databaseURL: "https://tracking-749fb-default-rtdb.firebaseio.com/"
  };

  
  
  firebase.initializeApp(firebaseConfig);
</script>

<script>
  
  function submitButton(){
    const driver = document.querySelector('#drivers').value
    console.log(driver)
    const database = firebase.database();
    const ref = database.ref(`/${driver}`);
    ref.push({
      "long": document.querySelector('#long').value,
      "lat": document.querySelector('#lat').value
    });
  }
</script>

<script>
  const database = firebase.database();
  const refroot = database.ref("/");
  refroot.on("value", function(snapshot) {
    const data = snapshot.val();
    if(data){
      document.querySelector('#drivers').innerHTML  = ""
      Object.entries(data).forEach(item=>{

        document.querySelector('#drivers').innerHTML += `<option value="${item[0]}">${item[0]}</option>`
      })
    }
  })


  // function updateLocation() {
  //     navigator.geolocation.getCurrentPosition(function(position) {
  //       var latitude = position.coords.latitude;
  //       var longitude = position.coords.longitude;

  //       // Update latitude and longitude on the page
  //       document.getElementById('lat').value = latitude;
  //       document.getElementById('long').value = longitude;
  //     });

  //     document.querySelector('#sbmtBtn').click()
  //   }

  //   // Update location initially
  //   updateLocation();

  //   // Update location every minute
  //   setInterval(updateLocation, 3000);

  // console.log("a")
</script>



</body>
</html>
